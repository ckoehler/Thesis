Before going into more detail about pulse compression, the general components of waveforms and their design will be
discussed. The basic elements of a waveform that can be manipulated are its amplitude, phase, frequency, and timing.
Each of these components can be designed to adhere to the required specifications, and will be described in more detail
in this chapter. Figure \ref{fig:basic_waveform} can be used as a reference.

\begin{figure}[h]
\includegraphics[width=\imgsize]{figures/basic_waveform_f.png}
\caption{A basic waveform showing amplitude, period, phase, pulse length, and PRT. Each component is explained in
more detail in this chapter.}
\label{fig:basic_waveform}
\end{figure}

\section{Pulse Repetition Time}
The pulse repetition time (PRT) is the time between two consecutive pulses and is often denoted as $T_s$.  Another way
to describe the timing of consecutive pulses is the pulse repetition frequency (PRF), which is simply the inverse of the
PRT. Both are used in literature to describe the same concept.

The PRT determines two very important aspects of a radar, the \emph{unambiguous range} $r_a$ and the \emph{unambiguous
velocity} $v_a$. They are given by the following equations \citep[p. 60-61]{Doviak:2006}.

\begin{equation}
\label{eq:unambrange}
r_a = \frac{c T_s}{2},
\end{equation}
where $ c = \SI{3e8}{\metre\per\second}$ is the speed of light, and

\begin{equation}
  \label{eq:unambvelocity}
  v_a = \pm \frac{\lambda}{4 T_s},
\end{equation}
where $\lambda$ is the wavelength of the radar.

The unambiguous range describes the maximum range of the radar up to which no second trip echoes occur.  A second trip
echo is the return signal caused by the first pulse, but is received after the second pulse has already been sent.
Referring to Figure \ref{fig:rangealiasing}, for
example, if $r_a = \SI{100}{\kilo\metre}$, and there is a target at a distance \SI{150}{\kilo\metre} from the radar, it
will appear to the radar to be only \SI{50}{\kilo\metre} away.  To increase the unambiguous range, a long PRT is
needed.

\begin{figure}[H]
\includegraphics[width=\imgsizes]{figures/rangealiasing.png}
\caption{Diagram explaining the unambiguous range. Targets that are outside the unambiguous range will fold over and
appear at the wrong location. }
\label{fig:rangealiasing}

\includegraphics[width=\imgsizes]{figures/velocityaliasing.png}
\caption{Diagram explaining the unambiguous velocity. Targets that move at velocities outside the unambiguous velocity will fold over and
appear to move more slowly than they actually do. }
\label{fig:velocityaliasing}
\end{figure}

The unambiguous velocity is measure of the maximum velocity that the radar can determine without velocity aliasing to
occur. The principle is similar to that of unambiguous range. Velocities ``wrap around'', so looking at Figure
\ref{fig:velocityaliasing}, e.g.,  with $v_a=
\SI{50}{\metre\per\second}$, a target moving at \SI{75}{\metre\per\second} will appear to only be moving at
\SI{25}{\metre\per\second} in the opposite direction. The reversal of the target's direction alone is an indicator of
how undesirable velocity aliasing is.


One important thing to notice is that, while the unambiguous range is proportional to the PRT, unambiguous velocity is
inversely proportional to it.  That means that, if the PRT is large, the unambiguous velocity will be low and velocity
aliasing will become more likely, but if the PRT is low, unambiguous range is low as well.  The resulting problem is
called the Doppler dilemma, which states that, for a given PRT, one can either achieve high unambiguous range or high
unambiguous velocity, but not both \citep[p.  60-61]{Doviak:2006}


\section{Staggered PRT}
As mentioned earlier, the problem with a single PRT is the so-called Doppler dilemma. A short
PRT provides high unambiguous Doppler velocity, while a long PRT gives us a long unambiguous range. Neither gives us
both.  To fix this problem, some radars use two different PRTs, a long and a short one, and combine measurements of both
to increase unambiguous velocity.  Typically, the long PRT is chosen based on the desired unambiguous range, while the
short PRT is chosen such that their combination maximizes the unambiguous velocity. The unambiguous velocity of two
staggered pulses of different lengths is defined as \citep[p. 173]{Doviak:2006}:

\begin{equation}
  \label{eq:vm}
  v_m = \pm \frac{\lambda}{4(T_{s2} - T_{s1})}
\end{equation}

The disadvantage of this method is a longer scan time, since every radial now has to be scanned twice, once with the short and once
with the long pulse, doubling the time between sweeps. For some applications, this is not an acceptable trade-off.

\section{Clutter Filtering}


\section{Inter-pulse Coding}
A coded pulse is in some way modulated, so it is not just rectangular. The idea is to code subsequent pulses with a
different phase, such that the received echoes can be paired up with a certain pulse. That way, an echo from the first
pulse that is received after the second pulse has already been transmitted can be identified to belong to the first
pulse and thus distinguished from echoes caused by the second pulse.

This allows the use of a small PRT, resulting in good unambiguous velocity, but also the ability to unfold second,
third, or even fourth trip echoes correctly. One such implementation is called SZ phase codes.  For this technique,
every other pulse is phase shifted by a certain sequence $a_k = e^{j \Psi_k}$. On receive, the signal can be decoded by
multiplying it with the complex conjugate of the coding sequence, $a^*_k$. For more details, refer to
\cite{Sachidananda:1999}.

\section{Pulse Length}
The previous techniques were independent of the pulse length. However, pulse length, usually
denoted by $\tau$, does affect the performance of the radar.  For example, by using a longer pulse, the target is
illuminated by more energy, thus increasing the sensitivity of the radar. On the other hand, a longer pulse will also
decrease range resolution, which is defined as

\begin{equation}
\label{eq:rangeres}
\Delta r = \frac{c \tau}{2}.
\end{equation}
However, depending on the application, simply increasing the pulse length to increase sensitivity may not be a desirable
solution.

The bandwidth of pulse is determined by its shape. Taking the Fourier transform of the pulse yields its frequency
spectrum. The spectrum of a perfectly rectangular pulse, shown in Figure \ref{fig:pulsespectrum}, looks like a sinc
function with sidelobes that extend into infinity, so its bandwidth is infinite bandwidth, making it impossible to
generate in a real system. 

\begin{figure}[h]
\includegraphics[width=\imgsize]{figures/pulsespectrum.png}
\caption{The frequency spectrum of a rectangular pulse. The sidelobes are cut off in the figure, but extend into
infinity.}
\label{fig:pulsespectrum}
\end{figure}

\section{Transmitters}
\label{s:transmitters}
The transmitter affects the amplitude and length of the pulse, determining the energy that is
transmitted onto the target.  This energy is usually expressed in terms of the radar's average power,which is an
important metric that relates the amplifier's peak power, pulse length, and pulse repetition time, as described in \cite[p.
74]{Skolnik:2001} and shown as Equation \eqref{eq:avgpower}.

\begin{equation}
  \label{eq:avgpower}
  P_{av} = \frac{P_t \tau}{T_s},
\end{equation}
The goal is to output as much power as possible to improve the maximum range and SNR of the radar .

The most commonly used transmitters are Klystrons, Magnetrons, Traveling Wave Tubes (TWT), and Solid-State Transistor
Amplifiers.  Klystrons are capable of high average and peak power with good gain and efficiency, and wide bandwidth
\citep[p. 692]{Skolnik:2001}.  However, to achieve large peak powers, high voltages and X-ray shielding are required,
limiting klystrons to mostly stationary radars that have access to a high voltage power source. Klystrons are
Linear-Beam Power Tubes in which electrons are emitted from a cathode, formed into a beam, and shot towards a
collector. Between the cathode and the collector are RF cavities at which the electrons interact with an input signal by
amplifying it. The amplified signal is then delivered to the output cavity and further down the transmit chain of the
radar.

TWTs are similar to klystrons in terms of architecture, but power and bandwidth are not as high as those of a
klystron.  Magnetrons are not technically amplifiers but oscillators. They are smaller than klystrons and operate at
lower voltages, but have poor noise and stability performance \citep[p. 693]{Skolnik:2001}.  Lastly, Solid-State
Transistor Amplifiers were already described briefly in Section \ref{s:par}, which mentioned that they operate at lower
voltages and have much lower gain than klystrons or magnetrons. On the other hand, they are very reliable, easy to
maintain, and have long life. They are also capable of wider bandwidth than klystrons or magnetrons \citep[p.
702]{Skolnik:2001}. If the long duty cycles and related need for longer pulses is acceptable, they are a good choice for
powering radars, especially in situations where size restricts the use of the other transmitters that have been
discussed.

Another important component is the low-noise amplifier (LNA) in the receive chain, which also influences the sensitivity
of the radar by amplifying the return signal while at the same time adding as little additional noise as possible. Using
better quality amplifiers in a system increases it price together with its performance, but is not always an option,
e.g., for legacy systems that are already operational or simply budget reasons for new systems.


\section{Matched Filter}
\label{s:2pc}
At the heart of pulse compression is the matched filter, which draws its name from the fact that it is matched to the
transmitted waveform. As the waveform passes through the filter, it is compressed in range and will ideally concentrate
most of the energy in a narrow mainlobe with no or low sidelobes. 
The matched filter is designed based on the maximization of the SNR. The following derivation traces the discussion
given in \cite[pp. 24-27]{Levanon:2004}.

Specifically, the SNR to be maximized is given by

\begin{equation}
  \label{eq:mfsnr}
  \left(\frac{S}{N}\right)_{out} = \frac{|s_o(t_0)|^2}{\overline{n_o^2(t)}},
\end{equation}
where $s_o$ is the output signal of the filter at a certain delay $t_0$, and $n_o$ is the Gaussian output noise, with
the $\overline{\text{bar}}$ denoting the mean-squared value. The variables influencing the output signal are the
original signal $s$ and some predetermined delay $t_0$. The whole output signal is then given by:

\begin{equation}
  \label{eq:mfso}
  s_o(t_0) = \frac{1}{2 \pi} \int_{-\infty}^{\infty} H(\omega) S(\omega) \exp(j \omega t_0) d\omega,
\end{equation}
where $S(\omega)$ is the Fourier transform of $s(t)$ and $H(\omega)$ the Fourier transform of $h(t)$, the impulse response
of the matched filter that needs to be derived. The exponential describes the delay $t_0$ in the frequency domain.
The output noise $N$ is described by:

\begin{equation}
  \label{eq:mfnoise}
  \overline{n_o^2(t)} = \frac{N_0}{4 \pi} \int_{-\infty}^{\infty} |H(\omega)|^2 d\omega.
\end{equation}

Before continuing this derivation, the \emph{Schwarz inequality} must be mentioned. It states that:

\begin{equation}
  \label{eq:schwarz}
  \left|\int_{-\infty}^{\infty} A(\omega) B(\omega) d\omega \right|^2 \leq 
    \int_{-\infty}^{\infty} |A(\omega)|^2 d\omega \int_{-\infty}^{\infty} |B(\omega)|^2 d\omega,
\end{equation}
for two complex signals $A(\omega)$ and $B(\omega)$. The two sides are exactly equal if and only if they are linearly
dependant:

\begin{equation}
  \label{eq:schwarzcond}
  A(\omega) = K B^*(\omega),
\end{equation}
where $K$ is an arbitrary constant.
Substituting Equations \eqref{eq:mfso} and \eqref{eq:mfnoise} back into Equation \eqref{eq:mfsnr} and applying the
Schwarz inequality with 

\begin{equation}
  \label{eq:schwarzsubst}
  A(\omega) = H(\omega) , B(\omega) = S(\omega)\exp(j \omega t_0), 
\end{equation}
yields

\begin{equation}
\label{eq:mfsnrmax}
  \left(\frac{S}{N}\right)_{out} \leq \frac{1}{\pi N_0} \int_{-\infty}^{\infty} |S(\omega)|^2 d\omega = \frac{2E}{N_0},
\end{equation}
where $E$ is the energy of the signal.

Substituting \eqref{eq:schwarzsubst} into \eqref{eq:schwarzcond} shows that the maximum output SNR is achieved when the
two sides of Equation \eqref{eq:mfsnrmax} are equal, i.e.:
\begin{equation}
  \label{eq:mffr}
  H(\omega) = K S^*(\omega) \exp(-j \omega t_0).
\end{equation}
Taking the inverse Fourier transform produces the impulse response of the matched filter:
\begin{equation}
  \label{eq:mfir}
  h(t) = K s^*(t_0-t)
\end{equation}
This reveals that the impulse response of the matched filter is the delayed mirror image of the conjugate of the
original signal $s(t)$. When the signal and filter are matched in this way, the condition of the Schwarz inequality
in Equation \eqref{eq:schwarzcond} is fulfilled and the SNR at $t=t_0$ is maximized with $\text{SNR}=\frac{2E}{N_0}$.

With $h(t)$ known, the output of the matched filter is then 
\begin{equation}
  \label{eq:filterresponse}
  s_o(t_0) = s(t) \star h(t) = \int_{-\infty}^{\infty}{s(\tau) K s^*[t_0 - (t - \tau)] d\tau}.
\end{equation}
Choosing the arbitrary gain constant $K=1$ and the predetermined delay $t_0=0$, the output can be recognized as the
autocorrelation function (ACF) of $s(t)$:
\begin{equation}
  \label{eq:acf}
  s_o(0) = \text{ACF}(s(t)) = \int_{-\infty}^{\infty}{s(\tau) s^*(\tau-t) d\tau}.
\end{equation}

The concept of the ACF for a rectangular pulse is shown in Figure \ref{fig:acf}.
This is an important function because it describes the output of the radar depending on the waveform $s(t)$ used. It is
the basis of analyzing the performance of radar signals in this work. As discussed before, the best result is achieved
when the filter matches the waveform exactly. If that is not the case and there is a mismatch between the filter and the
signal, there will be some loss called \emph{mismatch loss}. One reason for mismatch loss is the Doppler phase shift applied
to the return signal by a moving target. Adding that phase shift, given by $e^{-j 2 \pi f_d t}$, where $f_d$ is the
Doppler frequency, leads to the main tool of evaluating waveforms in this work, the \emph{Ambiguity
Function}, or AF.


\begin{figure}[h]
\includegraphics[width=\imgsize]{figures/acf.png}
\caption{ACF of a rectangular pulse. Similar to the convolution, the output of the matched filter of a
rectangular pulse is a triangle.}
\label{fig:acf}
\end{figure}


\section{Ambiguity Function}
\label{s:af}
In \cite{Rihaczek:1968}, the AF is defined as:

\begin{equation}
\label{eq:AF}
  |\chi(\tau,f_d)| = \left| \int_{-\infty}^\infty{u(t) u^*(t+\tau) e^{-j2\pi f_d t} dt}\right|,
\end{equation}
where $u(t)$ is the complex envelope of the signal and $\tau$ is the delay due to propagation, not to be confused with the
pulse length used in other places. It can clearly be seen that, for $f_d = 0$, the
AF reduces to the ACF, presented in Section \ref{s:2pc}.


For a simple rectangular pulse of the form $u(t)=\frac{1}{\sqrt{T}} rect(\frac{t}{T})$, the AF is \citep{Levanon:2004}:

\begin{align*}
  |\chi(\tau,f_d)| &= \left| \int_{-\infty}^\infty{u(t) u^*(t+\tau) e^{j2\pi f_d t} dt}\right| \\ 
  &= 
  \begin{cases}
    \frac{1}{T} \int_{-\frac{T}{2} + \tau}^{\frac{T}{2}}{e^{j2\pi f_d t}dt} & \text{for $0 \leq \tau \leq T$}, \\
    \frac{1}{T} \int_{-\frac{T}{2}}^{\frac{T}{2} + \tau}{e^{j2\pi f_d t}dt} & \text{for $-T \leq \tau < 0$}, \\
    0 & \text{otherwise}. \\
  \end{cases}
\end{align*}

Evaluate the integrals to get:

\begin{equation}
  |\chi(\tau,f_d)| = \left|\left(1-\frac{|\tau|}{T}\right) \frac{\sin[\pi T f_d(1- \frac{|\tau|}{T})]}{\pi T f_d(1- \frac{|\tau|}{T})}\right|, |\tau| \leq T, \text{zero elsewhere}
\end{equation}
For $\tau=0$, the result is the sinc function, for $f_d=0$ it is simply the ACF of a pulse, which is
a triangle.

The ideal shape of the AF depends on the application. One useful AF looks like a thumbtack and thus provides good range
and Doppler resolution.  However, this also means that any moving target will result in a weak or, for the ideal case,
no return signal due to the Doppler shift. A waveform with this characteristic can be used to detect targets whose velocity is already known,
since even a narrowly focused AF covers a certain range of Doppler velocities without much loss. As will be shown in the
simulations, this is the case for weather radar applications.

If a wider range of velocities has to be covered, several
different matched filters can be used, with each one matched to a different Doppler velocity range.  The reader is
referred to Chapter 7.2 of \citep{Levanon:2004} for more information. Alternatively, the AFs of some waveforms are
shaped like a ridge, so there will be a return signal no matter the Doppler shift. Chapter \ref{chap:pulsecompression} will
introduce one such waveform.




